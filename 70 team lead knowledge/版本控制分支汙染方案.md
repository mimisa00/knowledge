### mercurial 分支如果遭受汙染基本上沒救，這裡有一段沒救的解釋及處理方案 https://stackoverflow.com/questions/7000136/can-changes-made-by-strip-be-reflected-in-the-public-repo#answer-7003997 故需定義一定操作方式進行事後處理，實際運作時可能發生的分支汙染情況較大機率為超前合併，也就是說合併了不該在當次或未來數週維護週期的分支，但並非testing從此就不可再供使用，而是應思考被超前合併的testing內容何時可以進行更版，故列出以下SOP進行處理。
1. stript至未被汙染的header
2. create testing-date branch from testing branch
3. testing-${date}壓上 QAT UAT TAG (${date}請用數字取代..yymmdd)
4. release 合併 UAT TAG (testing-${date} branch)
5. 原 testing 循環週期未到又有新issue需進行更版
6. create branch and merge branch flow (比照原testing作法)
> - create version branch  from testing-${date} branch
> - create issue branch from version branch
> - version branch merge issue branch
> - testing-${date} branch merge version branch
7. testing-${date} 壓上 QAT UAT TAG
8. release 合併 UAT TAG
9. testing branch merge testing-${date} branch
10. testing 壓上 QAT UAT TAG
11. release 合併 UAT TAG (testing branch)
12. 如果超前合併的分支內容己確認不需要，則直接將 testing-date branch 整個資料夾覆蓋回 testing branch 即可 (注意.hg資料夾不可覆蓋!!)

## 上述1 ~ 12步驟範例情境操作
1. 當前擁有分支 1.0.0、2.0.0、3.0.0、4.0.0、testing，testing未合併分支4.0.0，UAT TAG錨點在 b95bbf0ef5cc
<img width="1102" height="428" alt="image" src="https://github.com/user-attachments/assets/fa4d055a-c7b2-472b-8afc-8fe4d04cc07e" />
2. testing 合併 4.0.0 並 push至版控系統
<img width="1216" height="419" alt="image" src="https://github.com/user-attachments/assets/e69dbcb1-a999-45dc-94fd-1c88324c8e28" />
3. 確認 4.0.0 無法在當次維護週期上版，需進行還原處置，點選欲還原的header後，點擊滑鼠右鍵執行strip from here
<img width="1159" height="431" alt="image" src="https://github.com/user-attachments/assets/0b0695d8-a2ad-40c2-be1d-4f61342f1119" />
4. 提示視窗確認
<img width="406" height="223" alt="image" src="https://github.com/user-attachments/assets/44c1cf96-0570-43af-a6ad-532f0aa91093" />
5. strip完 testing線停留在 [testing] merge [3.0.0] 的位置，而testing未更新內容則有三則 (ccba13993100、deae5af30b86、f8b9fc292323)
<img width="1172" height="531" alt="image" src="https://github.com/user-attachments/assets/5d6cc094-b204-4515-8b5e-9e9e9c9c616e" />
6. 此時建立新的 testing-date 分支 (暫時替代testing線)
<img width="602" height="203" alt="image" src="https://github.com/user-attachments/assets/ef95071c-1864-4e89-b4e2-00757353acaf" />
7. 執行commit
<img width="1152" height="505" alt="image" src="https://github.com/user-attachments/assets/7a2b7171-fb60-45f9-b4f9-1cd378cc3194" />
8. 輸入分支開立資訊
<img width="1398" height="779" alt="image" src="https://github.com/user-attachments/assets/948c7f2f-3f18-4909-9486-c6a8044393c5" />
9. 推送更新 (toolbar上方 Push)
<img width="1191" height="531" alt="image" src="https://github.com/user-attachments/assets/37d3b3db-19cd-4396-90fd-4f53348002ae" />
10. 拉回更新 (ccba13993100、deae5af30b86、f8b9fc292323)
<img width="1219" height="537" alt="image" src="https://github.com/user-attachments/assets/d5015dc4-bf26-43c6-af4f-1f1b41872720" />
11. 藍色區塊為原testing己合併的內容及建立的分支、黃色區塊為本次新增的testing-date分支
<img width="1100" height="449" alt="image" src="https://github.com/user-attachments/assets/deb30276-4a40-4ef6-82d9-a44dc4daed3f" />
12. 重新壓UAT TAG
<img width="1127" height="465" alt="image" src="https://github.com/user-attachments/assets/6a50f9da-944a-42b6-a72d-f6c15f688921" />
13. 切換至release線進行UAT TAG合併
<img width="1174" height="562" alt="image" src="https://github.com/user-attachments/assets/a23493fc-5588-4a97-8aa0-de46fd39335e" />
14. 衝突解決 > commit
<img width="1216" height="492" alt="image" src="https://github.com/user-attachments/assets/7337aff6-9f0e-4b87-afeb-e723271ca07b" />
15. 建立RL TAG then push
<img width="1139" height="565" alt="image" src="https://github.com/user-attachments/assets/5a820c05-e0c5-49b3-8fbc-e0a910ef7d77" />
16. 原 testing 循環維護週期未到，又有新issue需進行更版
17. create 3.1.0 from testing-date
<img width="1146" height="544" alt="image" src="https://github.com/user-attachments/assets/e92e62d5-004d-439c-8225-05ac6b6703d8" />
18. [testing-date] merge [3.1.0]
<img width="1156" height="561" alt="image" src="https://github.com/user-attachments/assets/71836326-4cd4-43e7-a2bf-fc26a82d2958" />
19. 壓RL過程同 12、13、14、15步驟
<img width="1168" height="536" alt="image" src="https://github.com/user-attachments/assets/846228dc-167e-452f-94b2-e211404e95c6" />
20. 原 testing 循環維護週期己到可以進行正常更版
21. [testing-date] merge [testing]  > 版本及.hgtags會衝突需手動排除 > [testing] merge [testing-date]
<img width="1179" height="616" alt="image" src="https://github.com/user-attachments/assets/76e25e40-45df-4bf2-9afa-7512eb29c8a7" />
22. 關閉 testing-date 分支，回復正常分支合併作業





  
